<?php
require('bd/conection.php'); //conexao

$nomeDisc = "Nenhuma disciplina selecionada"; //assume nome para a disciplina
$nomeAutor = ""; //assume nome para autor
$nomeLivro = ""; //assume nome para livro
$nomePessoa = ""; //assume nome para pessoa
$resposta = ""; //variavel incerta se vou usar

$usuario = ""; //assume para nome do usuario

session_start(); // abrir sessions

if(!isset($_SESSION['nome'])) { // se não existir a sessão com nome da disciplina 
    $usuario = "Desconhecido"; // assume como Desconhecido
} else { // se não
    $usuario = $_SESSION['nome']; //sessão nome assume o nome do usuario
}

if(isset($_POST['btn1'])) { //se o botão for pressionado -> isset = existe
    $nomeDisc = "Banco de Dados 1"; 
} else if(isset($_POST['btn2'])) { //se o botão for pressionado
    $nomeDisc = "Engenharia de Software 1";
} else if(isset($_POST['btn3'])) { //se o botão for pressionado
    $nomeDisc = "Estruturas de Dados 1";
} else if(isset($_POST['btn4'])) { //se o botão for pressionado
    $nomeDisc = "Noções de Economia";
} else if(isset($_POST['btn5'])) { //se o botão for pressionado
    $nomeDisc = "Redes de Computadores 1";
} else if(isset($_POST['btn6'])) { //se o botão for pressionado
    $nomeDisc = "Teoria Geral da Administração";
}

$sql = $pdo->prepare("SELECT * FROM livros WHERE Disciplina=?"); //seleciona valores da tabela atraves da variavel disciplina
$sql->execute(array($nomeDisc)); //coleta a variavel disciplina
$dados = $sql->fetchAll(); //assume os valores numa array

?>

<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Biblioteca Online BSI</title>
    <link rel="stylesheet" href="estilo1.css">
    <link rel="shortcut icon" href="imagens/favicon.ico" type="image/x-icon">
</head>
<body>
    <form action="" method="post">
        <nav>
            <img src="imagens/fundobiblioteca.jpg" alt=""> 
        </nav>
        <header>
            <ul>
                <li><a href="login.php"><?php echo $usuario ?></a></li>
            </ul>
        </header>
        <header>
            <main>
                <h2>Disciplinas:</h2>
                <button name="btn1">Banco de Dados 1</button><br>
                <button name="btn2">Engenharia de Software 1</button><br>
                <button name="btn3">Estruturas de Dados 1</button><br>
                <Button name="btn4">Noções de Economia</Button><br>
                <button name="btn5">Redes de Computadores 1</button><br>
                <button name="btn6">Teoria Geral da Administração</button><br>
            <br></main>
        </header>
        <header>
            <img src="imagens/barrainf.jpg" alt="">
        </header>
        <header>
            <main2>
                <?php
                if(isset($_POST['btn1']) & $usuario!="Desconhecido") { //se este botao for clicado e o usuario não for desconhecido
                    $nomeDisc = 'Banco de Dados 1'; //nome da displina
                    if(count($dados) > 0) { //se houver um ou mais dados no array 
                        foreach($dados as $chave => $valor) { //for para array ira passar chave em dadaos, valor irá assumir cada valor especifico
                            echo "<br><h2>$nomeDisc</h2>
                            <div>
                            <label><b>Arquivo:</b><a href='arquivos/".$valor['Nome']."' type='application/pdf' download=".$valor['Nome'].">".$valor['Nome']."</a></label><br>
                            <label><b>Autor:</b> ".$valor['Autor']."</label><br>
                            <label><b>Por:</b> ".$valor['Usuario']."</label><br>
                            </div><br>";
                        }
                    }
                    else { //se nao
                        echo "<br><br><p><b>Nenhum livro encontrado!</b></p><br><br>";
                    }
                    echo "<p><b>Deseja adicionar algum livro/artigo? <a href='cadlivros.php'>Sim</a></b></p>"; //opcao para inserir livro
                    $_SESSION['disciplina'] = $nomeDisc; //guarda o nome da discplina numa sessão para levar para outro arquivo
                } else if(isset($_POST['btn2']) & $usuario!="Desconhecido") { //se este botao for clicado e o usuario não for desconhecido
                    $nomeDisc = 'Engenharia de Software 1'; //nome da displina
                    if(count($dados) > 0) { //se houver um ou mais dados no array 
                        foreach($dados as $chave => $valor) { //for para array ira passar chave em dadaos, valor irá assumir cada valor especifico
                            echo "<br><h2>$nomeDisc</h2>
                            <div>
                            <label><b>Arquivo:</b><a href='arquivos/".$valor['Nome']."' type='application/pdf' download=".$valor['Nome'].">".$valor['Nome']."</a></label><br>
                            <label><b>Autor:</b> ".$valor['Autor']."</label><br>
                            <label><b>Por:</b> ".$valor['Usuario']."</label><br>
                            </div><br>";
                        }
                    }
                    else { //se nao
                        echo "<br><br><p><b>Nenhum livro encontrado!</b></p><br><br>";
                    }
                    echo "<p><b>Deseja adicionar algum livro/artigo? <a href='cadlivros.php'>Sim</a></b></p>"; //opcao para inserir livro
                    $_SESSION['disciplina'] = $nomeDisc; //guarda o nome da discplina numa sessão para levar para outro arquivo
                } else if(isset($_POST['btn3']) & $usuario!="Desconhecido") { //se este botao for clicado e o usuario não for desconhecido
                    $nomeDisc = 'Estrutura de Dados 1'; //nome da displina
                    if(count($dados) > 0) { //se houver um ou mais dados no array 
                        foreach($dados as $chave => $valor) { //for para array ira passar chave em dadaos, valor irá assumir cada valor especifico
                            echo "<br><h2>$nomeDisc</h2>
                            <div>
                            <label><b>Arquivo:</b><a href='arquivos/".$valor['Nome']."' type='application/pdf' download=".$valor['Nome'].">".$valor['Nome']."</a></label><br>
                            <label><b>Autor:</b> ".$valor['Autor']."</label><br>
                            <label><b>Por:</b> ".$valor['Usuario']."</label><br>
                            </div><br>";
                        }
                    }
                    else { //se nao
                        echo "<br><br><p><b>Nenhum livro encontrado!</b></p><br><br>";
                    }
                    echo "<p><b>Deseja adicionar algum livro/artigo? <a href='cadlivros.php'>Sim</a></b></p>"; //opcao para inserir livro
                    $_SESSION['disciplina'] = $nomeDisc; //guarda o nome da discplina numa sessão para levar para outro arquivo
                } else if(isset($_POST['btn4']) & $usuario!="Desconhecido") { //se este botao for clicado e o usuario não for desconhecido
                    $nomeDisc = 'Noções de Economia'; //nome da displina
                    if(count($dados) > 0) { //se houver um ou mais dados no array 
                        foreach($dados as $chave => $valor) { //for para array ira passar chave em dadaos, valor irá assumir cada valor especifico
                            echo "<br><h2>$nomeDisc</h2>
                            <div>
                            <label><b>Arquivo:</b><a href='arquivos/".$valor['Nome']."' type='application/pdf' download=".$valor['Nome'].">".$valor['Nome']."</a></label><br>
                            <label><b>Autor:</b> ".$valor['Autor']."</label><br>
                            <label><b>Por:</b> ".$valor['Usuario']."</label><br>
                            </div><br>";
                        }
                    }
                    else { //se nao
                        echo "<br><br><p><b>Nenhum livro encontrado!</b></p><br><br>";
                    }
                    echo "<p><b>Deseja adicionar algum livro/artigo? <a href='cadlivros.php'>Sim</a></b></p>"; //opcao para inserir livro
                    $_SESSION['disciplina'] = $nomeDisc; //guarda o nome da discplina numa sessão para levar para outro arquivo
                } else if(isset($_POST['btn5']) & $usuario!="Desconhecido") { //se este botao for clicado e o usuario não for desconhecido
                    $nomeDisc = 'Redes de computadores 1'; //nome da displina
                    if(count($dados) > 0) { //se houver um ou mais dados no array 
                        foreach($dados as $chave => $valor) { //for para array ira passar chave em dadaos, valor irá assumir cada valor especifico
                            echo "<br><h2>$nomeDisc</h2>
                            <div>
                            <label><b>Arquivo:</b><a href='arquivos/".$valor['Nome']."' type='application/pdf' download=".$valor['Nome'].">".$valor['Nome']."</a></label><br>
                            <label><b>Por:</b> ".$valor['Usuario']."</label><br>
                            </div><br>";
                        }
                    }
                    else { //se nao
                        echo "<br><br><p><b>Nenhum livro encontrado!</b></p><br><br>";
                    }
                    echo "<p><b>Deseja adicionar algum livro/artigo? <a href='cadlivros.php'>Sim</a></b></p>"; //opcao para inserir livro
                    $_SESSION['disciplina'] = $nomeDisc; //guarda o nome da discplina numa sessão para levar para outro arquivo
                } else if(isset($_POST['btn6']) & $usuario!="Desconhecido") { //se este botao for clicado e o usuario não for desconhecido
                    $nomeDisc = 'Teoria Geral da Administração'; //nome da displina
                    if(count($dados) > 0) { //se houver um ou mais dados no array 
                        foreach($dados as $chave => $valor) { //for para array ira passar chave em dadaos, valor irá assumir cada valor especifico
                            echo "<br><h2>$nomeDisc</h2> 
                            <div>
                            <label><b>Arquivo:</b><a href='arquivos/".$valor['Nome']."' type='application/pdf' download=".$valor['Nome'].">".$valor['Nome']."</a></label><br>
                            <label><b>Autor:</b> ".$valor['Autor']."</label><br>
                            <label><b>Por:</b> ".$valor['Usuario']."</label><br>
                            </div><br>";
                        }
                    }
                    else { //se nao
                        echo "<br><br><p><b>Nenhum livro encontrado!</b></p><br><br>";
                    }
                    echo "<p><b>Deseja adicionar algum livro/artigo? <a href='cadlivros.php'>Sim</a></b></p>";
                    $_SESSION['disciplina'] = $nomeDisc; //guarda o nome da discplina numa sessão para levar para outro arquivo
                } else {
                   echo "<p><b>Você não está logado! <u><a href='login.php'> Clique aqui!</a></u></b></p>";
                }
                
                ?>
            </main2>
        </header>
        <header>
            <image>

            </image>
        </header>
    </form>
    <br><br><footer>
        &copy; sistemas de informação | 2020-2022
    </footer>
</body>
</html>